import{_ as L}from"./5o-Y2MLE.js";import{u as $,T as d}from"./Dd-TMUED.js";import{u as j}from"./_otGHgF4.js";import{l as R,n as V,j as B,m as w,c as o,a as t,b as v,p as b,w as f,k as u,t as i,D as g,d as p,F as y,r as _,o as n}from"./CcuqGOUj.js";const U={class:"trades-container"},G={key:0,class:"flex justify-center my-10"},J={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6"},M={key:2,class:"text-center my-10"},F={class:"flex flex-col w-40 mx-auto"},Y={key:3,class:"mb-6"},z={class:"border-b border-gray-200"},q={class:"flex -mb-px"},H={key:0,class:"ml-1 bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full"},K={key:4,class:"grid gap-4"},O={class:"flex justify-between items-center p-4 border-b bg-gray-50"},Q={class:"flex items-center"},W={class:"mr-3"},X={key:0,class:"text-blue-500"},Z={key:1,class:"text-green-500"},ee={class:"font-medium"},te={class:"font-semibold"},se={class:"text-sm text-gray-500"},re={class:"flex items-center"},oe={class:"p-4"},ne={class:"grid grid-cols-2 gap-4"},ae={class:"font-medium mb-2 text-sm text-gray-600"},de={class:"grid grid-cols-3 gap-2"},le={class:"text-xs"},ie={key:0,class:"text-gray-500 text-sm"},ue={class:"font-medium mb-2 text-sm text-gray-600"},ce={class:"grid grid-cols-3 gap-2"},xe={class:"text-xs"},be={key:0,class:"text-gray-500 text-sm"},me={class:"p-4 border-t bg-gray-50 flex justify-between"},ge={key:0,class:"flex space-x-2"},pe=["onClick","disabled"],ye=["onClick","disabled"],ve=["onClick","disabled"],fe={key:5,class:"text-center my-10"},Ee={__name:"index",setup(_e){const a=$(),h=j(),D=R(),l=V("all");B(async()=>{await Promise.all([a.fetchAllTrades(),h.fetchAllUsernames()])});const C=w(()=>l.value==="all"?(console.log(a.trades),a.trades):l.value==="pending"?a.trades.filter(r=>r.status===d.PENDING):l.value==="completed"?a.trades.filter(r=>r.status===d.ACCEPTED||r.status===d.REJECTED||r.status===d.CANCELED):[]),k=w(()=>a.trades.filter(r=>r.status===d.PENDING).length),x=r=>{var e;return r.initiatorId===((e=D.user)==null?void 0:e.id)},N=r=>{const e=h.publicUsernames.find(m=>m.id===r);return e?e.username:r.substring(0,8)},S=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),A=r=>{switch(r){case d.PENDING:return"Pending";case d.ACCEPTED:return"Accepted";case d.REJECTED:return"Rejected";case d.CANCELED:return"Canceled";default:return r}},P=r=>{switch(r){case d.PENDING:return"bg-yellow-100 text-yellow-800";case d.ACCEPTED:return"bg-green-100 text-green-800";case d.REJECTED:return"bg-red-100 text-red-800";case d.CANCELED:return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},T=r=>r.substring(0,8)+"...",E=async(r,e)=>{await a.respondToTrade(r,{accept:e})},I=async r=>{await a.cancelTrade(r)};return(r,e)=>{const m=L;return n(),o("div",U,[e[16]||(e[16]=t("div",{class:"mb-8"},[t("h1",{class:"text-2xl font-bold"},"My Trades"),t("p",{class:"text-gray-600"},"Manage your card trade offers")],-1)),v(m,{to:"/trades/create",class:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition"},{default:f(()=>e[5]||(e[5]=[t("span",{class:"material-icons"},"Start Trade",-1)])),_:1}),u(a).loading?(n(),o("div",G,e[6]||(e[6]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"},null,-1)]))):u(a).error?(n(),o("div",J,[t("p",null,i(u(a).error),1),t("button",{onClick:e[0]||(e[0]=(...s)=>u(a).resetErrorState&&u(a).resetErrorState(...s)),class:"text-sm underline"},"Dismiss")])):u(a).trades.length===0?(n(),o("div",M,[e[8]||(e[8]=t("div",{class:"text-5xl mb-4"},"ðŸƒ",-1)),e[9]||(e[9]=t("h3",{class:"text-xl font-medium mb-2"},"No trades yet",-1)),e[10]||(e[10]=t("p",{class:"text-gray-600 mb-6"},"Start trading cards with other collectors!",-1)),t("div",F,[v(m,{to:"/cards",class:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition"},{default:f(()=>e[7]||(e[7]=[p(" Browse Cards ")])),_:1})])])):(n(),o("div",Y,[t("div",z,[t("nav",q,[t("button",{onClick:e[1]||(e[1]=s=>l.value="all"),class:g(["px-4 py-2 mr-2 font-medium text-sm",l.value==="all"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"])}," All Trades ",2),t("button",{onClick:e[2]||(e[2]=s=>l.value="pending"),class:g(["px-4 py-2 mr-2 font-medium text-sm",l.value==="pending"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"])},[e[11]||(e[11]=p(" Pending ")),k.value>0?(n(),o("span",H,i(k.value),1)):b("",!0)],2),t("button",{onClick:e[3]||(e[3]=s=>l.value="completed"),class:g(["px-4 py-2 mr-2 font-medium text-sm",l.value==="completed"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"])}," Completed ",2)])])])),C.value.length>0?(n(),o("div",K,[(n(!0),o(y,null,_(C.value,s=>(n(),o("div",{key:s.id,class:"border rounded-lg overflow-hidden hover:shadow-md transition bg-white"},[t("div",O,[t("div",Q,[t("div",W,[x(s)?(n(),o("span",X,e[12]||(e[12]=[t("span",{class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full"},"Sent",-1)]))):(n(),o("span",Z,e[13]||(e[13]=[t("span",{class:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full"},"Received",-1)])))]),t("div",null,[t("h3",ee,[p(i(x(s)?"Trade to ":"Trade from ")+" ",1),t("span",te,i(N(x(s)?s.receiverId:s.initiatorId)),1)]),t("p",se,i(S(s.createdAt)),1)])]),t("div",re,[t("span",{class:g(["text-sm px-3 py-1 rounded-full",P(s.status)])},i(A(s.status)),3)])]),t("div",oe,[t("div",ne,[t("div",null,[t("h4",ae,i(x(s)?"Your offer":"Their offer"),1),t("div",de,[(n(!0),o(y,null,_(s.initiatorCards,c=>(n(),o("div",{key:c,class:"border rounded p-1 text-center"},[t("div",le,"Card ID: "+i(T(c)),1)]))),128)),s.initiatorCards.length===0?(n(),o("div",ie,"No cards")):b("",!0)])]),t("div",null,[t("h4",ue,i(x(s)?"Their cards":"Your cards"),1),t("div",ce,[(n(!0),o(y,null,_(s.receiverCards,c=>(n(),o("div",{key:c,class:"border rounded p-1 text-center"},[t("div",xe,"Card ID: "+i(T(c)),1)]))),128)),s.receiverCards.length===0?(n(),o("div",be,"No cards")):b("",!0)])])])]),t("div",me,[v(m,{to:`/trades/${s.id}`,class:"text-blue-500 hover:text-blue-700 text-sm font-medium"},{default:f(()=>e[14]||(e[14]=[p(" View Details ")])),_:2},1032,["to"]),s.status==="pending"?(n(),o("div",ge,[x(s)?(n(),o("button",{key:0,onClick:c=>I(s.id),class:"text-sm px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition",disabled:u(a).loading}," Cancel Trade ",8,pe)):b("",!0),x(s)?b("",!0):(n(),o(y,{key:1},[t("button",{onClick:c=>E(s.id,!0),class:"text-sm px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded transition",disabled:u(a).respondTradeLoading}," Accept ",8,ye),t("button",{onClick:c=>E(s.id,!1),class:"text-sm px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded transition",disabled:u(a).respondTradeLoading}," Reject ",8,ve)],64))])):b("",!0)])]))),128))])):l.value!=="all"?(n(),o("div",fe,[e[15]||(e[15]=t("p",{class:"text-gray-600"},"No trades found in this category",-1)),t("button",{onClick:e[4]||(e[4]=s=>l.value="all"),class:"text-blue-500 hover:text-blue-600 mt-2"},"View all trades")])):b("",!0)])}}};export{Ee as default};
