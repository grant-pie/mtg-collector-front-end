import{E as s,y as r}from"./CpfRM8F9.js";const i=s("auth",{state:()=>({token:null,user:null,loading:!1,error:null}),getters:{isAuthenticated(){return!!this.token},isAdmin(){var t;return((t=this.user)==null?void 0:t.role)==="admin"}},actions:{setToken(t){this.token=t,localStorage.setItem("token",t)},setUser(t){this.user=t},async fetchUser(){var t;if(this.token){this.loading=!0,this.error=null;try{const e=await $fetch(`${r().public.apiBaseUrl}/auth/profile`,{headers:{Authorization:`Bearer ${this.token}`}});this.user=e}catch(e){console.error("Error fetching user:",e),this.error="Failed to load user profile",((t=e==null?void 0:e.response)==null?void 0:t.status)===401&&this.logout()}finally{this.loading=!1}}},async initAuth(){{const t=localStorage.getItem("token");t&&(this.token=t,await this.fetchUser())}},logout(){this.token=null,this.user=null,localStorage.removeItem("token")},updateUserData(t){this.user&&(this.user={...this.user,...t})}}});export{i as u};
